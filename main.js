(()=>{"use strict";var t={56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},72:t=>{var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var o={},a=[],s=0;s<t.length;s++){var c=t[s],A=i.base?c[0]+i.base:c[0],d=o[A]||0,p="".concat(A," ").concat(d);o[A]=d+1;var l=n(p),u={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==l)e[l].references++,e[l].updater(u);else{var m=r(u,i);i.byIndex=s,e.splice(s,0,{identifier:p,updater:m,references:1})}a.push(p)}return a}function r(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,r){var o=i(t=t||[],r=r||{});return function(t){t=t||[];for(var a=0;a<o.length;a++){var s=n(o[a]);e[s].references--}for(var c=i(t,r),A=0;A<o.length;A++){var d=n(o[A]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}o=c}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},314:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,r,o){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(i)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var A=0;A<t.length;A++){var d=[].concat(t[A]);i&&a[d[0]]||(void 0!==o&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=o),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),e.push(d))}},e}},354:t=>{t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),o="/*# ".concat(r," */");return[e].concat([o]).join("\n")}return[e].join("\n")}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},659:t=>{var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},795:(t,e,n)=>{n.d(e,{A:()=>s});var i=n(354),r=n.n(i),o=n(314),a=n.n(o)()(r());a.push([t.id,"body{margin:0;padding:0;padding-left:150px;padding-right:150px;font-size:20px}.container{width:100%;display:flex;flex-direction:column}.top-panel{margin-top:10px;text-align:right}.tickets-list{margin-top:10px;padding-top:10px;min-height:100px;border-radius:10px}.button{background-color:#fff;border:1px solid #000;border-radius:10px;padding:10px 10px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;transition-duration:.4s}.button:hover{background-color:#c5c5c5;cursor:pointer}.items-item{display:flex;justify-content:center;flex-wrap:wrap;gap:20px;padding:15px;border:1px solid #000}.item-status{width:30px;cursor:pointer;border:1px solid #000;border-radius:15px;text-align:center}.item-name{width:600px;cursor:pointer}.item-description{width:100%;padding:30px}.edit-item{border-radius:15px;border:1px solid #000;text-align:center;padding:0;width:30px;height:30px;cursor:pointer}.delete-item{border-radius:15px;border:1px solid #000;text-align:center;padding:0;width:30px;height:30px;cursor:pointer}.ticket-form{width:40%;position:absolute;top:25vh;left:30vw;background-color:#fff;border-radius:10px;border:1px solid #000;padding:10px}.ticket-form .form-caption{text-align:center;margin-top:10px;margin-bottom:10px}.ticket-form .form-caption h3{padding:0;margin:0}.ticket-form .form-group label{display:block}.ticket-form .form-group input[type=text],.ticket-form .form-group textarea{width:98%;font-size:20px}.ticket-form .form-group textarea{height:70px}.ticket-form .buttons-list{margin-top:20px;text-align:right}.ticket-form .buttons-list button{font-size:15px;width:100px;height:30px}.form-block{height:100%}","",{version:3,sources:["webpack://./src/css/style.scss"],names:[],mappings:"AAAA,KACC,QAAA,CACA,SAAA,CACA,kBAAA,CACA,mBAAA,CACA,cAAA,CAID,WAEC,UAAA,CACA,YAAA,CACA,qBAAA,CAGD,WACC,eAAA,CACA,gBAAA,CAID,cACI,eAAA,CACH,gBAAA,CAGA,gBAAA,CACA,kBAAA,CAGD,QACC,qBAAA,CACA,qBAAA,CACA,kBAAA,CAEA,iBAAA,CACA,iBAAA,CACA,oBAAA,CACA,oBAAA,CACA,cAAA,CACA,uBAAA,CACA,cACC,wBAAA,CACA,cAAA,CAKD,YACA,YAAA,CACA,sBAAA,CACA,cAAA,CAEA,QAAA,CACA,YAAA,CACA,qBAAA,CAID,aACC,UAAA,CACA,cAAA,CACA,qBAAA,CACA,kBAAA,CACA,iBAAA,CAID,WACC,WAAA,CACA,cAAA,CAID,kBACC,UAAA,CACA,YAAA,CAGD,WACC,kBAAA,CACA,qBAAA,CACA,iBAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,cAAA,CAKD,aACC,kBAAA,CACA,qBAAA,CACA,iBAAA,CACA,SAAA,CACA,UAAA,CACA,WAAA,CACA,cAAA,CAID,aACC,SAAA,CACA,iBAAA,CACA,QAAA,CACA,SAAA,CACA,qBAAA,CACA,kBAAA,CACA,qBAAA,CACA,YAAA,CACA,2BACC,iBAAA,CACA,eAAA,CACA,kBAAA,CACA,8BACC,SAAA,CACA,QAAA,CAIC,+BACF,aAAA,CAEE,4EACF,SAAA,CACA,cAAA,CAEE,kCACF,WAAA,CAID,2BACC,eAAA,CACA,gBAAA,CACA,kCACC,cAAA,CACA,WAAA,CACA,WAAA,CAMH,YACC,WAAA",sourcesContent:["body {\n\tmargin: 0;\n\tpadding: 0;\n\tpadding-left: 150px;\n\tpadding-right: 150px;\n\tfont-size: 20px;\n}\n\n\n.container {\n\t// background-color: lightblue;\n\twidth: 100%;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.top-panel {\n\tmargin-top: 10px;\n\ttext-align: right;\n\t// border: 1px solid black;\n}\n\n.tickets-list {\n    margin-top: 10px;\n\tpadding-top: 10px;\n\t// border: 1px solid black;\n\t// background-color: rgb(93, 172, 247);\n\tmin-height: 100px;\n\tborder-radius: 10px;\n}\n\n.button {\n\tbackground-color: white; /* Green */\n\tborder: 1px solid black;\n\tborder-radius: 10px;\n\t//color: white;\n\tpadding: 10px 10px;\n\ttext-align: center;\n\ttext-decoration: none;\n\tdisplay: inline-block;\n\tfont-size: 16px;\n\ttransition-duration: 0.4s;\n\t&:hover {\n\t\tbackground-color: #c5c5c5; /* Green */ \n\t\tcursor: pointer;\n\t}\n  }\n\n\n .items-item {\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-wrap: wrap;\n\n\tgap: 20px;\n\tpadding: 15px;\n\tborder: 1px solid black;\n\t\n}\n\n.item-status {\n\twidth: 30px;\n\tcursor: pointer;\n\tborder: 1px solid black;\n\tborder-radius: 15px;\n\ttext-align: center;\n}\n\n\n.item-name {\n\twidth: 600px;\n\tcursor: pointer;\n}\n\n\n.item-description {\n\twidth: 100%;\n\tpadding: 30px;\n}\n\n.edit-item {\n\tborder-radius: 15px;\n\tborder: 1px solid black;\n\ttext-align: center;\n\tpadding: 0;\n\twidth: 30px;\n\theight: 30px;\n\tcursor: pointer;\n\n}\n\n\n.delete-item {\n\tborder-radius: 15px;\n\tborder: 1px solid black;\n\ttext-align: center;\n\tpadding: 0;\n\twidth: 30px;\n\theight: 30px;\n\tcursor: pointer;\n}\n\n\n.ticket-form {\n\twidth: 40%;\n\tposition: absolute;\n\ttop: 25vh;\n\tleft: 30vw;\n\tbackground-color: white;\n\tborder-radius: 10px;\n\tborder: 1px solid black;\n\tpadding: 10px;\n\t.form-caption {\n\t\ttext-align: center;\n\t\tmargin-top: 10px;\n\t\tmargin-bottom: 10px;\n\t\th3 {\n\t\t\tpadding: 0;\n\t\t\tmargin: 0;\n\t\t}\n\t}\n\t.form-group {\n\t   label {\n\t\tdisplay: block;\n\t   }\n\t   input[type=text], textarea {\n\t\twidth: 98%;\n\t\tfont-size: 20px;\n\t   }\n\t   textarea {\n\t\theight: 70px;\n\t   }\n\n\t}\n\t.buttons-list {\n\t\tmargin-top: 20px;\n\t\ttext-align: right;\n\t\tbutton{\n\t\t\tfont-size: 15px;\n\t\t\twidth: 100px;\n\t\t\theight: 30px;\n\n\t\t}\n\t}\n}\n\n.form-block {\n\theight: 100%;\n}"],sourceRoot:""}]);const s=a},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var r=void 0!==n.layer;r&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,r&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,exports:{}};return t[i](o,o.exports,n),o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0;var i=n(72),r=n.n(i),o=n(825),a=n.n(o),s=n(659),c=n.n(s),A=n(56),d=n.n(A),p=n(540),l=n.n(p),u=n(113),m=n.n(u),h=n(795),C={};C.styleTagTransform=m(),C.setAttributes=d(),C.insert=c().bind(null,"head"),C.domAPI=a(),C.insertStyleElement=l(),r()(h.A,C),h.A&&h.A.locals&&h.A.locals;class f{constructor(t){this.elContainer=t}static get markup(){return'<button type="button" class="button addTicket">Добавить тикет</button>'}static get selector(){return".button.addTicket"}bindToDOM(){this.elContainer.innerHTML=f.markup}}class b{constructor(t,e){this.parentEl=t,this.data=e,this.toggleDescription=this.toggleDescription.bind(this),this.refreshData=this.refreshData.bind(this)}static get markup(){return'\n       <div class="items"></div>\n          '}bindToDOM(){this.parentEl.innerHTML=b.markup,this.items=this.parentEl.querySelector(".items"),this.refreshData(this.data)}addItem(t){const e=document.createElement("div");e.classList.add("items-item"),e.setAttribute("ticket_id",t.id);const n=document.createElement("div");n.classList.add("item-status"),"1"===t.status&&(n.textContent="✔");const i=document.createElement("div");i.classList.add("item-name"),i.textContent=t.name;const r=document.createElement("div");r.classList.add("item-datetime"),r.textContent=t.created;const o=document.createElement("div");o.classList.add("edit-item"),o.textContent="✎";const a=document.createElement("div");return a.classList.add("delete-item"),a.textContent="x",e.appendChild(n),e.appendChild(i),e.appendChild(r),e.appendChild(o),e.appendChild(a),this.items.appendChild(e),e}toggleDescription(t){if(t){console.log(t.id);const e=this.items.querySelector(`[ticket_id="${t.id}"]`);let n=e.querySelector(".item-description");n?n.remove():(n=document.createElement("div"),n.classList.add("item-description"),n.textContent=t.description,e.appendChild(n))}}refreshData(t){t&&(this.items.innerHTML="",t.forEach((t=>{this.addItem(t)})))}}class g{constructor(t,e,n,i,r){this.element=t,this.caption=e,this.formType=n,this.onSubmit=this.onSubmit.bind(this),this.onCancel=this.onCancel.bind(this),this.markup=this.markup.bind(this),this.callBack=i,this.ticketObj=r,this.formRemove=this.formRemove.bind(this)}markup(){return this.formType<=1?`<form class="ticket-form">\n       <div class="form-caption"><h3>${this.caption}</h3></div>\n       <div class="form-group">\n        <label for="ticket-name">Краткое описание</label>\n        <input type="text" name="ticket-name" value="${this.ticketObj.name}" autocomplete="off">\n       </div>\n       <div class="form-group">\n         <label for="ticket-descriptoin">Подробное описание</label>\n         <textarea name="ticket-description">${this.ticketObj.description}</textarea>\n        </div>  \n        <div class="buttons-list">\n          <button type="button" class="cancel">Отмена</button>\n          <button class="submit">ОК</button>\n        </div>\n    </form>`:`<form class="ticket-form">\n       <div class="form-caption"><h3>${this.caption}</h3></div>\n       <div class="form-group">\n        <p>Вы уверены, что хотите удалить тикет? Это действие необратимо.</p>\n       </div>\n        <div class="buttons-list">\n          <button type="button" class="cancel">Отмена</button>\n          <button class="submit">ОК</button>\n        </div>\n    </form>`}static get submitSelector(){return".submit"}static get formSelector(){return".ticket-form"}static get cancelSelector(){return".cancel"}bindToDOM(){this.element.innerHTML=this.markup(),this.form=this.element.querySelector(g.formSelector),this.form.addEventListener("submit",this.onSubmit),this.cancel=this.element.querySelector(g.cancelSelector),this.cancel.addEventListener("click",this.onCancel)}formRemove(){this.cancel.removeEventListener("click",this.onCancel),this.form.removeEventListener("submit",this.onCancel),this.form.remove()}onSubmit(t){t.preventDefault(),2===this.formType&&this.callBack(),this.formType<2&&(Array.from(this.form.elements).filter((({name:t})=>t)).forEach((t=>{this.ticketObj[t.name.split("-")[1]]=t.value})),this.callBack(this.ticketObj)),this.formRemove()}onCancel(){this.formRemove()}}const x="http://localhost:3000",v=()=>fetch(`${x}?method=allTickets`).then((t=>t.json())),k=document.querySelector(".top-panel");let y;const E=document.querySelector(".tickets-list"),B=document.querySelector(".form-block");let S,w,T=[],D={};D=()=>{E.querySelectorAll(".edit-item").forEach((t=>{(t=>{t.addEventListener("click",(t=>{const e=t.target.parentElement.getAttribute("ticket_id"),n=T.filter((t=>t.id===e))[0];S=new g(B,"Исправить тикет",1,(()=>(t=>{(t=>fetch(`${x}?method=updateTicket`,{method:"PATCH",body:JSON.stringify({id:t.id,name:t.name,description:t.description,status:t.status}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((()=>v())))(t).then((t=>{T=t,w.refreshData(T),D()}))})(n)),n),S.bindToDOM()}))})(t)})),E.querySelectorAll(".delete-item").forEach((t=>{(t=>{t.addEventListener("click",(t=>{const e=t.target.parentElement.getAttribute("ticket_id");S=new g(B,"Удалить тикет",2,(()=>{var t;(t=e,fetch(`${x}?method=deleteTicket&id=${t}`,{method:"DELETE"}).then((()=>v()))).then((t=>{T=t,w.refreshData(T),D()}))})),S.bindToDOM()}))})(t)})),E.querySelectorAll(".item-status").forEach((t=>{(t=>{t.addEventListener("click",(t=>{(t=>{const e=T.filter((e=>e.id===t))[0];var n;e.status="0"===e.status?"1":"0",(n=e,fetch(`${x}?method=updateStatusTicket`,{method:"PATCH",body:JSON.stringify({id:n.id,status:n.status}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((()=>v()))).then((t=>{T=t,w.refreshData(T),D()}))})(t.target.parentElement.getAttribute("ticket_id"))}))})(t)})),E.querySelectorAll(".item-name").forEach((t=>{(t=>{t.addEventListener("click",(t=>{const e=t.target.parentElement.getAttribute("ticket_id");var n;(n=e,fetch(`${x}?method=ticketById&id=${n}`).then((t=>t.json()))).then((t=>{const n=T.filter((t=>t.id===e))[0],{name:i,description:r,status:o}=t;n.name=i,n.description=r,n.status=o,w.toggleDescription(n)}))}))})(t)}))},document.addEventListener("DOMContentLoaded",(()=>{v().then((t=>{T=t,w=new b(E,T),w.bindToDOM(),D()})),new f(k).bindToDOM(),y=document.querySelector(".addTicket"),y.addEventListener("click",(()=>{const t={id:null,name:"",description:""};S=new g(B,"Добавить тикет",0,(()=>{(t=>fetch(`${x}?method=createTicket`,{method:"POST",body:JSON.stringify({id:null,name:t.name,description:t.description,status:"0"}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((()=>v())))(t).then((t=>{T=t,w.refreshData(T),D()}))}),t),S.bindToDOM()}))}))})();
//# sourceMappingURL=main.js.map